<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>HLS TV Player - Manual Play + Auto Reload + Ads + Buffering</title>

<meta name="monetag" content="f6122dcf0ae0344432a93322d9615e30">

<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    background: #000;
    overflow: hidden;
  }

  #video-container {
    position: fixed;
    inset: 0;
    background: #000;
  }

  video {
    width: 100%;
    height: 100%;
    object-fit: contain;
    background: #000;
  }

  #playBtn {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 70px;
    color: white;
    background: rgba(0,0,0,0.5);
    padding: 25px 40px;
    border-radius: 50%;
    cursor: pointer;
    z-index: 10000;
    border: 2px solid white;
    transition: opacity 0.3s ease;
  }

  #unmuteBtn {
    position: absolute;
    top: 10px;
    left: 10px;
    z-index: 9999;
    background: rgba(0,0,0,0.6);
    color: white;
    padding: 10px 16px;
    border-radius: 8px;
    font-size: 16px;
    border: 1px solid white;
    cursor: pointer;
  }

  #fullscreenBtn {
    position: absolute;
    bottom: 10px;
    right: 10px;
    z-index: 9999;
    background: rgba(0,0,0,0.6);
    color: white;
    padding: 10px 16px;
    border-radius: 8px;
    font-size: 18px;
    border: 1px solid white;
    cursor: pointer;
  }

  /* --------------------------
       BUFFERING LOADING
  ---------------------------*/
  #loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    color: white;
    z-index: 9999;
    display: none;
  }

  #spinner {
    border: 6px solid rgba(255, 255, 255, 0.2);
    border-top: 6px solid white;
    border-radius: 50%;
    width: 60px;
    height: 60px;
    margin: 0 auto 10px;
    animation: spin 1s linear infinite;
  }

  #bufferPercent {
    font-size: 18px;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
</style>
</head>

<body>

<div id="video-container">
  <video id="player" playsinline muted></video>

  <div id="playBtn">‚ñ∂Ô∏è</div>
  <button id="unmuteBtn">üîä Unmute</button>
  <button id="fullscreenBtn">‚õ∂</button>

  <!-- BUFFERING LOADING -->
  <div id="loading">
    <div id="spinner"></div>
    <div id="bufferPercent">0%</div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.7"></script>

<script>
const video = document.getElementById("player");
const playBtn = document.getElementById("playBtn");
const unmuteBtn = document.getElementById("unmuteBtn");
const fullscreenBtn = document.getElementById("fullscreenBtn");
const loading = document.getElementById("loading");
const bufferPercent = document.getElementById("bufferPercent");
const manifest = "https://shorten.is/nba4";

let hls;
let lastTime = 0;

/* --------------------------
    MONETAG ADS ON BUTTONS
---------------------------*/
(function loadMonetag() {
  const s1=document.createElement('script'); s1.dataset.zone='10131170'; s1.src='https://al5sm.com/tag.min.js'; s1.async=true;
  const s2=document.createElement('script'); s2.dataset.zone='10131172'; s2.src='https://groleegni.net/vignette.min.js'; s2.async=true;
  document.body.appendChild(s1); document.body.appendChild(s2);
})();
function triggerMonetag(){ if(window.MonetagReload) window.MonetagReload(); }
[playBtn, unmuteBtn, fullscreenBtn].forEach(btn => btn.addEventListener('click', triggerMonetag));

/* --------------------------
        START VIDEO
---------------------------*/
function startVideo() {
  playBtn.style.opacity = 0;
  setTimeout(() => playBtn.style.display = "none", 300);

  loading.style.display = "block";
  bufferPercent.textContent = "0%";

  if (video.canPlayType("application/vnd.apple.mpegurl")) {
    video.src = manifest;
    video.addEventListener('loadeddata', () => loading.style.display = 'none');
    video.play();
  } else if (Hls.isSupported()) {
    hls = new Hls();
    hls.loadSource(manifest);
    hls.attachMedia(video);

    hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());

    // BUFFERING PERCENT
    hls.on(Hls.Events.FRAG_BUFFERING, (event, data) => {
      if(data.stats && data.stats.total){
        let percent = Math.min(100, Math.floor((data.stats.loaded / data.stats.total) * 100));
        bufferPercent.textContent = percent + "%";
      }
    });

    hls.on(Hls.Events.FRAG_BUFFERED, () => loading.style.display = 'none');

    hls.on(Hls.Events.ERROR, (event, data) => {
      if(data.fatal){
        console.log("HLS error, reloading stream...");
        reloadStream();
      }
    });
  }
}

/* --------------------------
        RELOAD STREAM
---------------------------*/
function reloadStream() {
  loading.style.display = "block";
  bufferPercent.textContent = "0%";
  if(hls) hls.destroy();
  startVideo();
}

/* --------------------------
       PLAY BUTTON
---------------------------*/
playBtn.addEventListener("click", startVideo);
document.addEventListener("keydown", (e) => {
  if(e.key === "Enter" || e.key === " ") startVideo();
});

/* --------------------------
       UNMUTE BUTTON
---------------------------*/
unmuteBtn.addEventListener("click", () => {
  video.muted = false;
  video.volume = 1.0;
  unmuteBtn.style.display = "none";
});

/* --------------------------
       FULLSCREEN BUTTON
---------------------------*/
fullscreenBtn.addEventListener("click", () => {
  const vc = document.getElementById("video-container");
  if(!document.fullscreenElement) vc.requestFullscreen();
  else document.exitFullscreen();
});

/* --------------------------
    AUTO RELOAD ON FREEZE
---------------------------*/
setInterval(() => {
  if(!video.paused && video.currentTime === lastTime){
    console.log("Video frozen, reloading...");
    reloadStream();
  }
  lastTime = video.currentTime;
}, 4000);

/* --------------------------
    VIDEO ERROR EVENT
---------------------------*/
video.addEventListener("error", () => {
  console.log("Video element error, reloading...");
  reloadStream();
});
</script>

</body>
</html>
